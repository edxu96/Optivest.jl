VERSION 17
*TRNSED
*******************************************************************************
*** TRNSYS input file (deck) generated by TrnsysStudio
*** on tirsdag, april 25, 2017 at 16:12
*** from TrnsysStudio project: C:\Trnsys17\MyProjects\Marstal11117\Sunstore4_v1-5-01_course11117.TPF
*** 
*** If you edit this file, use the File/Import TRNSYS Input File function in 
*** TrnsysStudio to update the project. 
*** 
*** If you have problems, questions or suggestions please contact your local 
*** TRNSYS distributor or mailto:software@cstb.fr 
*** 
*******************************************************************************
*******************************************************************************
*|<BACKGROUND> rgb(239,236,255)
*|<img src="Images\SUNSTORE4-scheme.jpg" align="center">
*|<COLOR1> rgb(204,0,0)
*|<SIZE1> 20
*|<ALIGN1> CENTER
*|<STYLE1> ITALIC BOLD
*|[HEADER|
*|* A CALCULATION PROGRAM OF A SOLAR HEATING PLANT
*|<SIZE1> 12
*|*  (Jianhua Fan, DTU)
*|<SIZE1> 10
*
*
*
*
*
*
*
*
*
*
*
*
*
*
*
*
*
*|*Last updated: 11.11.2019
*
*|<STYLE1> NORMAL
*|<COLOR1> NAVY
*|<SIZE1> 10
*|* This is a Trnsys simulation program of a typical solar heating plant. 
*|*   The program should only be used for course 47330 at DTU. 
*|]
 
*|<COLOR1> rgb(204,0,0)
*|<ALIGN1> LEFT
*|<STYLE1> BOLD
*|<SIZE1> 12
*|*
*
*
*******************************************************************************
*|[ NRcon | The district heating net 
CONSTANTS  4
   Demand_net= 6.0820000000000E+04
*|Demand of the district heating net      |MWh|-|0|1|1000|6400000.0|997
   Deghours_sum= 7.7560000000000E+04
*|Sum of degree*hour per year      |-|-|0|1|30000|150000|997
   T_net_forward= 7.0000000000000E+01
*|Forward temperature to the net      |C|-|0|1|50|100|997
   T_net_return= 4.0000000000000E+01
*|Return temperature from the net     |C|-|0|1|20|80|997
*|]
*
*******************************************************************************
*
*|[ NRcon | Solar collector 
CONSTANTS  14
   coll1_area = 9.0430000000000E+03
*|Collector field 1: Area      |m^2|-|0|1|1000|1000000.0|997
   coll1_eta0 = 7.6000000000000E-01
*|Collector field 1: n0      |-|-|0|1|0.0001|1.00|997
   coll1_a1 = 1.2600000000000E+01
*|Collector field 1: a_1 (1 W/m^2.K=3.6 kJ/hr.m^2.K)  |kJ/hr.m^2.K|-|0|1|0.1|50.00|997
   coll1_a2 = 7.0000000000000E-03
*|Collector field 1: a_2 (1 W/m^2.K^2=3.6 kJ/hr.m^2.K^2)    |kJ/hr.m^2.K^2|-|0|1|0.0|50.000|997
   coll2_area = 9.1240000000000E+03
*|Collector field 2: Area      |m^2|-|0|1|1000|1000000.0|997
   coll2_eta0 = 8.1000000000000E-01
*|Collector field 2: n0      |-|-|0|1|0.0001|1.00|997
   coll2_a1 = 9.2500000000000E+00
*|Collector field 2: a_1 (1 W/m^2.K=3.6 kJ/hr.m^2.K)  |kJ/hr.m^2.K|-|0|1|0.1|50.00|997
   coll2_a2 = 2.8000000000000E-02
*|Collector field 2: a_2 (1 W/m^2.K^2=3.6 kJ/hr.m^2.K^2)    |kJ/hr.m^2.K^2|-|0|1|0.0|50.000|997
   coll3_area = 1.5000000000000E+04
*|Collector field 3: Area      |m^2|-|0|1|1000|1000000.0|997
   coll3_eta0 = 8.5000000000000E-01
*|Collector field 3: n0      |-|-|0|1|0.0001|1.00|997
   coll3_a1 = 1.1050000000000E+01
*|Collector field 3: a_1 (1 W/m^2.K=3.6 kJ/hr.m^2.K)  |kJ/hr.m^2.K|-|0|1|0.1|50.00|997
   coll3_a2 = 3.6000000000000E-02
*|Collector field 3: a_2 (1 W/m^2.K^2=3.6 kJ/hr.m^2.K^2)    |kJ/hr.m^2.K^2|-|0|1|0.0|50.000|997
   collector_slope = 3.5000000000000E+01
*|All collector fields: Collector slop      |degree|-|0|1|0|90|997
   row_distance = 4.5000000000000E+00
*|All collector fields: Row distance      |m|-|0|1|3|8.0|997
*
*|]
*
*******************************************************************************
*|[ NRcon | Water pit heat storage
CONSTANTS  5
   V_pit = 6.0000000000000E+04
*|Volume of water pit      |m^3|-|0|1|5000|2000000|997
   h-d-ratio_pit= 7.0500000000000E-02
*|Height to diameter ratio      |-|-|0|1|0.001|1.0000|997
   Thick_insu_pit= 2.0000000000000E-01
*|Thickness of insulation on the top of pit      |m|-|0|1|0.01|5.00|997
   Lamda_insu_pit= 1.6000000000000E-01
*|Thermal conductivity of insulation (1 W/m.K= 3.6 kJ/hr.m.K)      |kJ/hr.m.K|-|0|1|0.01|5.00|997
   nrsegment= 9.1000000000000E+01
*|Number of segment of heat storage      |-|-|0|1|10|100|997
*
*|]
*
*******************************************************************************
*|[ NRcon | Steel tank water heat storage
CONSTANTS  4
   V_tank = 2.1000000000000E+03
*|Volume of steel tank      |m^3|-|0|1|100|500000|997
   h-d-ratio_tank= 6.6120000000000E-01
*|Height to diameter ratio      |-|-|0|1|0.001|1.0000|997
   UA_tank= 1.0000000000000E+03
*|Overall heat loss cofficient (1 W/K= 3.6 kJ/hr.k)    |kJ/hr.K|-|0|1|0.01|10000.00|997
   nrtanknodes= 1.1000000000000E+01
*|Number of segment of heat storage      |-|-|0|1|10|100|997
*
*|]
*
*|[ NRcon | Heat pump
CONSTANTS  1
   Heatpump_P_kW = 4.7500000000000E+02
*|Power of heat pump      |kW|-|0|1|100|2000.0|997
*|]
*
*|[ NRcon | Condensing boiler and ORC
CONSTANTS  1
   boiler_ORC_Q_kW= 4.4930000000000E+03
*|Power of the boiler+ORC      |kW|-|0|1|1000|20000.0|997
*
*|]
*|[ NRcon | Biooil backup boiler
CONSTANTS  1
  biooil_Qmax_kj_per_h= 3.6000000000000E+07
*|Power of biooil back boiler (1 W= 3.6 kJ/hr)     |kJ/hr|-|0|1|1000000|200000000.0|997
*|]
*
*|[ NRcon | Economy analysis
CONSTANTS  9
  interest_rate_Input= 8.0240000000000E-02
*|Annual_payment_rate (8.024% for a 20 year loan with an annual interest rate of 5%)      |-|-|0|1|0.001|1.00000|997
  Cost_coll1_Krperm2= 1.2000000000000E+03
*|Collector field 1: cost per area      |DKK/m^2|-|0|1|0.1|10000|997
  Cost_coll2_Krperm2= 1.5000000000000E+03
*|Collector field 2: cost per area      |DKK/m^2|-|0|1|0.1|10000|997
  Cost_coll3_Krperm2= 1.5000000000000E+03
*|Collector field 3: cost per area      |DKK/m^2|-|0|1|0.1|10000|997
  cost_pit_pervolume = 1.1000000000000E+02
*|Water pit heat storage: cost per volume        |DKK/m^3|-|0|1|10|10000|997
  cost_tank_pervolume = 7.0000000000000E+02
*|Tank heat storage: cost per volume       |DKK/m^3|-|0|1|100|10000|997
  cost_woodchip_perMWH= 2.0000000000000E+02
*|Cost of heat by woodchip per MWh       |DKK/MWh|-|0|1|10|10000|997
  cost_HP_perMWH= 1.0000000000000E+02
*|Cost of heat by heat pump per MWh       |DKK/MWh|-|0|1|10|10000|997
  cost_biooil_perMWH= 4.0000000000000E+02
*|Cost of heat by biooil per MWh       |DKK/MWh|-|0|1|10|10000|997
*
*|]
*
*******************************************************************************
*** Units 
*******************************************************************************
*
*******************************************************************************
*** Control cards
*******************************************************************************
* START, STOP and STEP
CONSTANTS 3
START=0
STOP=17520
STEP=1
SIMULATION 	 START	 STOP	 STEP	! Start time	End time	Time step
TOLERANCES 0.01 0.01			! Integration	 Convergence
LIMITS 30 30 30				! Max iterations	Max warnings	Trace limit
DFQ 1					! TRNSYS numerical integration solver method
WIDTH 80				! TRNSYS output file width, number of characters
*
LIST 					! NOLIST statement
					! MAP statement
SOLVER 0 1 1				! Solver statement	Minimum relaxation factor	Maximum relaxation factor
NAN_CHECK 0				! Nan DEBUG statement
OVERWRITE_CHECK 0			! Overwrite DEBUG statement
TIME_REPORT 0			! disable time report
EQSOLVER 0				! EQUATION SOLVER statement
* User defined CONSTANTS 
Constants = 15
*
*
*
*
Radiation_factor = 1000 / 988.4
*
*coll2_area =   9124
*coll3_area = 15000
*
*coll2_eta0 = 0.81
*coll3_eta0 = 0.85
*
*coll2_a1 = 2.57 * 3.6
*coll3_a1 = 3.07 * 3.6
*
*coll2_a2 = 0.0079 * 3.6
*coll3_a2 = 0.01 * 3.6
*row_distance = 4.5
*
cp_water = 4.19
cp_glycol = 3.973
*boiler_ORC_Q_kW=3200 * 0.98 + 234 + 1123
Boiler_start = 24 * 280
Boiler_stop = 24 * 160
*Heatpump_P_kW=475
Heat_pump_1_start = 24 * 273
Heat_pump_1_stop = 24 * 91
Heat_pump_2_start = 24 * 273
Heat_pump_2_stop = 24 * 91
*V_pit = 75000
*h-d-ratio_pit = 0.0705
h_pit = (4*(h-d-ratio_pit)^2*V_pit/3.141592654)^(1/3)
d_pit = h_pit/h-d-ratio_pit
A_pit = d_pit^2 * 3.1416/4 + d_pit*3.1416*h_pit
*Thick_insu_pit = 0.5
*Lamda_insu_pit=0.36
*V_tank = 2100
*h-d-ratio_tank = 0.6116
h_tank = (4*(h-d-ratio_tank)^2*V_tank/3.141592654)^(1/3)
d_tank = h_tank/h-d-ratio_tank
A_tank = d_tank^2 * 3.1416/4 + d_tank*3.1416*h_tank
*UA_tank = A_tank * 0.3838*3.6
*biooil_Qmax_kj_per_h=36000000
*Cost_coll1_Krperm2=1500
*Cost_coll2_Krperm2=1500
*Cost_coll3_Krperm2=1500
*cost_pit_pervolume = 110
*cost_tank_pervolume = 700
*interest_rate_Input=0.08024
*
* Model "Elspot" (Type 9)
* 
*
UNIT 33 TYPE 9	 Elspot
*$UNIT_NAME Elspot
*$MODEL .\Utility\Data Readers\Generic Data Files\First Line is Simulation Start\Free Format\Type9a.tmf
*$POSITION -297 702
*$LAYER Weather - Data Files # 
PARAMETERS 58
2		! 1 Mode
3		! 2 Header Lines to Skip
13		! 3 No. of values to read
1.0		! 4 Time interval of data
-1		! 5 Interpolate or not?-1
1.0		! 6 Multiplication factor-1
0		! 7 Addition factor-1
1		! 8 Average or instantaneous value-1
-1		! 9 Interpolate or not?-2
1.0		! 10 Multiplication factor-2
0		! 11 Addition factor-2
1		! 12 Average or instantaneous value-2
-1		! 13 Interpolate or not?-3
1.0		! 14 Multiplication factor-3
0		! 15 Addition factor-3
1		! 16 Average or instantaneous value-3
-1		! 17 Interpolate or not?-4
1.0		! 18 Multiplication factor-4
0		! 19 Addition factor-4
1		! 20 Average or instantaneous value-4
-1		! 21 Interpolate or not?-5
1.0		! 22 Multiplication factor-5
0		! 23 Addition factor-5
1		! 24 Average or instantaneous value-5
-1		! 25 Interpolate or not?-6
1.0		! 26 Multiplication factor-6
0		! 27 Addition factor-6
1		! 28 Average or instantaneous value-6
-1		! 29 Interpolate or not?-7
1.0		! 30 Multiplication factor-7
0		! 31 Addition factor-7
1		! 32 Average or instantaneous value-7
-1		! 33 Interpolate or not?-8
1.0		! 34 Multiplication factor-8
0		! 35 Addition factor-8
1		! 36 Average or instantaneous value-8
-1		! 37 Interpolate or not?-9
1.0		! 38 Multiplication factor-9
0		! 39 Addition factor-9
1		! 40 Average or instantaneous value-9
-1		! 41 Interpolate or not?-10
1.0		! 42 Multiplication factor-10
0		! 43 Addition factor-10
1		! 44 Average or instantaneous value-10
-1		! 45 Interpolate or not?-11
1.0		! 46 Multiplication factor-11
0		! 47 Addition factor-11
1		! 48 Average or instantaneous value-11
-1		! 49 Interpolate or not?-12
1.0		! 50 Multiplication factor-12
0		! 51 Addition factor-12
1		! 52 Average or instantaneous value-12
-1		! 53 Interpolate or not?-13
1.0		! 54 Multiplication factor-13
0		! 55 Addition factor-13
1		! 56 Average or instantaneous value-13
33		! 57 Logical unit for input file
-1		! 58 Free format mode
*** External files
ASSIGN "Inputdata\Elspotpriser2.txt" 33
*|? Input file name |1000
*------------------------------------------------------------------------------
*
* Model "T-forward" (Type 14)
* 
*
UNIT 73 TYPE 14	 T-forward
*$UNIT_NAME T-forward
*$MODEL .\Utility\Forcing Functions\Temperature\Type14e.tmf
*$POSITION -221 702
*$LAYER Weather - Data Files # 
PARAMETERS 12
0		! 1 Initial value of time
T_net_forward		! 2 Initial temperature
1460		! 3 Time at point-1
T_net_forward		! 4 Temperature at point -1
2920		! 5 Time at point-2
T_net_forward		! 6 Temperature at point -2
5110		! 7 Time at point-3
T_net_forward		! 8 Temperature at point -3
6570		! 9 Time at point-4
T_net_forward		! 10 Temperature at point -4
8760		! 11 Time at point-5
T_net_forward		! 12 Temperature at point -5
*------------------------------------------------------------------------------
*
* Model "T-return" (Type 14)
* 
*
UNIT 71 TYPE 14	 T-return
*$UNIT_NAME T-return
*$MODEL .\Utility\Forcing Functions\Temperature\Type14e.tmf
*$POSITION -142 702
*$LAYER Weather - Data Files # 
PARAMETERS 12
0		! 1 Initial value of time
T_net_return		! 2 Initial temperature
2190		! 3 Time at point-1
T_net_return		! 4 Temperature at point -1
4380		! 5 Time at point-2
T_net_return		! 6 Temperature at point -2
5840		! 7 Time at point-3
T_net_return		! 8 Temperature at point -3
7300		! 9 Time at point-4
T_net_return		! 10 Temperature at point -4
8760		! 11 Time at point-5
T_net_return		! 12 Temperature at point -5
*------------------------------------------------------------------------------
*
* Model "Type109-TMY2" (Type 109)
* 
*
UNIT 31 TYPE 109	 Type109-TMY2
*$UNIT_NAME Type109-TMY2
*$MODEL .\Weather Data Reading and Processing\Standard Format\TMY2\Type109-TMY2.tmf
*$POSITION -271 104
*$LAYER Weather - Data Files # 
PARAMETERS 4
2		! 1 Data Reader Mode
32		! 2 Logical unit
4		! 3 Sky model for diffuse radiation
1		! 4 Tracking mode
INPUTS 3
0,0		! [unconnected] Ground reflectance
0,0		! [unconnected] Slope of surface
0,0		! [unconnected] Azimuth of surface
*** INITIAL INPUT VALUES
0.2 collector_slope 0.0 
*** External files
ASSIGN "C:\Users\s192476\Downloads\EKYT_HDD_18C (2).csv" 32
*|? Weather data file |1000
*------------------------------------------------------------------------------
*
* Model "DegDays" (Type 9)
* 
*
UNIT 88 TYPE 9	 DegDays
*$UNIT_NAME DegDays
*$MODEL .\Utility\Data Readers\Generic Data Files\First Line is Simulation Start\Free Format\Type9a.tmf
*$POSITION 758 690
*$LAYER Weather - Data Files # 
PARAMETERS 10
2		! 1 Mode
1		! 2 Header Lines to Skip
1		! 3 No. of values to read
24		! 4 Time interval of data
-1		! 5 Interpolate or not?
1.0		! 6 Multiplication factor
0		! 7 Addition factor
1		! 8 Average or instantaneous value
37		! 9 Logical unit for input file
-1		! 10 Free format mode
*** External files
ASSIGN "Inputdata\DegreeDays.txt" 37
*|? Input file name |1000
*------------------------------------------------------------------------------
*
* Model "Delay-4" (Type 93)
* 
*
UNIT 103 TYPE 93	 Delay-4
*$UNIT_NAME Delay-4
*$MODEL .\Utility\Input Value Recall\Type93.tmf
*$POSITION 217 113
*$LAYER Controls # 
PARAMETERS 2
1		! 1 Number of inputs to be stored
1		! 2 Number of timesteps to be stored
INPUTS 1
0,0		! [unconnected] Input value
*** INITIAL INPUT VALUES
0 
*------------------------------------------------------------------------------
*
* EQUATIONS "Dummy"
* 
EQUATIONS 1
Dummy = 0
*$UNIT_NAME Dummy
*$LAYER BTES
*$POSITION 466 50
*
*------------------------------------------------------------------------------
*
*
* EQUATIONS "Investment"
* 
EQUATIONS 23
Inv_collectors1 = Cost_coll1_Krperm2 * (Coll1_area)+500000*min(Coll1_area,1)
Inv_collectors2 = Cost_coll2_Krperm2 * (Coll2_area)+500000*min(Coll2_area,1)
Inv_collectors3 = Cost_coll3_Krperm2 * (Coll3_area)+500000*min(Coll3_area,1)
Inv_pit = (12300000 + cost_pit_pervolume * V_pit )*1+0*min(Coll1_area+Coll2_area+Coll3_area,1)
Inv_tank = cost_tank_pervolume *V_tank+1500000
Inv_ground = 220 * 50000
Inv_central = 6500000 +0* min(Coll1_area+Coll2_area+Coll3_area,1)
Inv_hp = (2800000 * Heatpump_P_kW/1000+ 300000 )  *min(Heatpump_P_kW*1000*3.6,1)
Inv_abs = 0.0   
Inv_boiler = boiler_ORC_Q_kW/1000 * (17000000-3000000) /(2+6)+3000000
Inv_aux = biooil_Qmax_kj_per_h / 3.6e6 *112000+857000
Investment_total = Inv_collectors1+Inv_collectors2+Inv_collectors3 + Inv_pit+Inv_tank + Inv_ground + Inv_central   + Inv_hp + Inv_abs + Inv_boiler + Inv_aux
interest_rate = interest_rate_2p5
interest_rate_1p0 = 0.05542
interest_rate_1p5 = 0.05825
interest_rate_2p0 = 0.06116
interest_rate_2p5 = 0.06415
interest_rate_3p0 = 0.06772
interest_rate_3p5 = 0.07036
interest_rate_4p0 = 0.07358
interest_rate_4p5 = 0.07688
interest_rate_5p0 = 0.08024
Financial_costs = Investment_total*interest_rate_Input
*$UNIT_NAME Investment
*$LAYER Main
*$POSITION 746 187
*
*------------------------------------------------------------------------------
*
*
* EQUATIONS "Global"
* 
EQUATIONS 4
T_ambient = [31,1]
T_forward = [73,2]
T_return = [71,2]
Elspot_hours = [33,13]
*$UNIT_NAME Global
*$LAYER Controls
*$POSITION -220 622
*
*------------------------------------------------------------------------------
*
*
* Model "9.000 m2" (Type 1)
* 
*
UNIT 3 TYPE 1	 9.000 m2
*$UNIT_NAME 9.000 m2
*$MODEL .\Solar Thermal Collectors\Quadratic Efficiency Collector\2nd-Order Incidence Angle Modifiers\Type1b.tmf
*$POSITION -167 176
*$LAYER Water Loop # 
PARAMETERS 11
20		! 1 Number in series
coll1_area		! 2 Collector area
cp_glycol		! 3 Fluid specific heat
2		! 4 Efficiency mode
72		! 5 Tested flow rate
coll1_eta0		! 6 Intercept efficiency
coll1_a1		! 7 Efficiency slope
coll1_a2		! 8 Efficiency curvature
2		! 9 Optical mode 2
0.1008		! 10 1st-order IAM
0.0		! 11 2nd-order IAM
INPUTS 9
HX1_WS_T_out		! HX-1:HX1_WS_T_out ->Inlet temperature
Pump_1_m		! Pump-1:Pump_1_m ->Inlet flowrate
31,1 		! Type109-TMY2:Ambient temperature ->Ambient temperature
shadow_rad_total		! Shadow:shadow_rad_total ->Incident radiation
0,0		! [unconnected] Total horizontal radiation
0,0		! [unconnected] Horizontal diffuse radiation
0,0		! [unconnected] Ground reflectance
31,22 		! Type109-TMY2:angle of incidence for tilted surface  ->Incidence angle
31,23 		! Type109-TMY2:slope of tilted surface ->Collector slope
*** INITIAL INPUT VALUES
20.0 100.0 10.0 0. 0.0 0.0 0.2 45.0 0. 
*------------------------------------------------------------------------------
*
* EQUATIONS "Shadow"
* 
EQUATIONS 6
field_slope = 0
collector_height = 2.275
shadow_angle = atan( sin( collector_slope - field_slope )  / max( 1e-6 , row_distance/collector_height * 2/cos(field_slope)  - cos( collector_slope - field_slope ) ) ) - field_slope
shadow_rad_beam = [31,19]  * max( 0 , min( 1 , row_distance / collector_height  / cos( field_slope ) * sin( 90 - [31,10] + field_slope )  / max( 1e-6 , sin( 90 - [31,10] + collector_slope ) ) ) )
shadow_rad_diffuse = [31,20]  * max( 0 , min( 1 , ( 180 - collector_slope - shadow_angle )  / max( 1e-6 , 180 - collector_slope ) ) )
shadow_rad_total = Radiation_factor * ( shadow_rad_beam + shadow_rad_diffuse )
*$UNIT_NAME Shadow
*$LAYER Weather - Data Files
*$POSITION -272 175
*
*------------------------------------------------------------------------------
*
*
* Model "9.300 m2" (Type 1)
* 
*
UNIT 47 TYPE 1	 9.300 m2
*$UNIT_NAME 9.300 m2
*$MODEL .\Solar Thermal Collectors\Quadratic Efficiency Collector\2nd-Order Incidence Angle Modifiers\Type1b.tmf
*$POSITION -172 319
*$LAYER Water Loop # 
PARAMETERS 11
20		! 1 Number in series
coll2_area		! 2 Collector area
cp_glycol		! 3 Fluid specific heat
2		! 4 Efficiency mode
72		! 5 Tested flow rate
coll2_eta0		! 6 Intercept efficiency
coll2_a1		! 7 Efficiency slope
coll2_a2		! 8 Efficiency curvature
2		! 9 Optical mode 2
0.1008		! 10 1st-order IAM
0.0		! 11 2nd-order IAM
INPUTS 9
HX2_WS_T_out		! HX-2:HX2_WS_T_out ->Inlet temperature
Pump_2_m		! Pump-2:Pump_2_m ->Inlet flowrate
31,1 		! Type109-TMY2:Ambient temperature ->Ambient temperature
shadow_rad_total		! Shadow:shadow_rad_total ->Incident radiation
0,0		! [unconnected] Total horizontal radiation
0,0		! [unconnected] Horizontal diffuse radiation
0,0		! [unconnected] Ground reflectance
31,22 		! Type109-TMY2:angle of incidence for tilted surface  ->Incidence angle
31,23 		! Type109-TMY2:slope of tilted surface ->Collector slope
*** INITIAL INPUT VALUES
20.0 100.0 10.0 0. 0.0 0.0 0.2 45.0 0. 
*------------------------------------------------------------------------------
*
* Model "15.000 m2" (Type 1)
* 
*
UNIT 54 TYPE 1	 15.000 m2
*$UNIT_NAME 15.000 m2
*$MODEL .\Solar Thermal Collectors\Quadratic Efficiency Collector\2nd-Order Incidence Angle Modifiers\Type1b.tmf
*$POSITION -172 463
*$LAYER Water Loop # 
PARAMETERS 11
20		! 1 Number in series
coll3_area		! 2 Collector area
cp_glycol		! 3 Fluid specific heat
2		! 4 Efficiency mode
72		! 5 Tested flow rate
coll3_eta0		! 6 Intercept efficiency
coll3_a1		! 7 Efficiency slope
coll3_a2		! 8 Efficiency curvature
2		! 9 Optical mode 2
0.1008		! 10 1st-order IAM
0.0		! 11 2nd-order IAM
INPUTS 9
HX3_WS_T_out		! HX-3:HX3_WS_T_out ->Inlet temperature
Pump_3_m		! Pump-3:Pump_3_m ->Inlet flowrate
31,1 		! Type109-TMY2:Ambient temperature ->Ambient temperature
shadow_rad_total		! Shadow:shadow_rad_total ->Incident radiation
0,0		! [unconnected] Total horizontal radiation
0,0		! [unconnected] Horizontal diffuse radiation
0,0		! [unconnected] Ground reflectance
31,22 		! Type109-TMY2:angle of incidence for tilted surface  ->Incidence angle
31,23 		! Type109-TMY2:slope of tilted surface ->Collector slope
*** INITIAL INPUT VALUES
20.0 100.0 10.0 0. 0.0 0.0 0.2 45.0 0. 
*------------------------------------------------------------------------------
*
* EQUATIONS "Heat-load"
* 
EQUATIONS 7
Load_MWh_pr_year = demand_net
GAF_ratio = 0.709
DegHours_pr_year = Deghours_sum
GUF_MW = ( 1 - GAF_ratio ) * Load_MWh_pr_year / 8760
GAF_MW = GAF_ratio * Load_MWh_pr_year * [88,1] / DegHours_pr_year
Load_kJ_pr_h = ( GUF_MW + GAF_MW ) * 3.6e6
Load_m = Load_kJ_pr_h / cp_water / max( 1 , T_forward - T_return )
*$UNIT_NAME Heat-load
*$LAYER Water Loop
*$POSITION 503 701
*
*------------------------------------------------------------------------------
*
*
* Model "CO2-HP" (Type 65)
* 
*
UNIT 81 TYPE 65	 CO2-HP
*$UNIT_NAME CO2-HP
*$MODEL .\Output\Online Plotter\Online Plotter Without File\Type65d.tmf
*$POSITION 258 697
*$LAYER Outputs # 
PARAMETERS 12
10		! 1 Nb. of left-axis variables
10		! 2 Nb. of right-axis variables
0.0		! 3 Left axis minimum
1000.0		! 4 Left axis maximum
0.0		! 5 Right axis minimum
10		! 6 Right axis maximum
2		! 7 Number of plots per simulation
12		! 8 X-axis gridpoints
0		! 9 Shut off Online w/o removing
-1		! 10 Logical unit for output file
0		! 11 Output file units
0		! 12 Output file delimiter
INPUTS 20
VP_varm_T_ud		! HP-CO2:VP_varm_T_ud ->Left axis variable-1
VP_varm_m		! HP-CO2:VP_varm_m ->Left axis variable-2
VP_kold_T_ud		! HP-CO2:VP_kold_T_ud ->Left axis variable-3
VP_kold_m		! HP-CO2:VP_kold_m ->Left axis variable-4
VP_ON		! HP-CO2:VP_ON ->Left axis variable-5
VP_P_kW		! HP-CO2:VP_P_kW ->Left axis variable-6
VP_P_kJ_pr_h		! HP-CO2:VP_P_kJ_pr_h ->Left axis variable-7
VP_P		! HP-CO2:VP_P ->Left axis variable-8
VP_COP_varm		! HP-CO2:VP_COP_varm ->Left axis variable-9
VP_Q_varm_nom		! HP-CO2:VP_Q_varm_nom ->Left axis variable-10
VP_Q_kold		! HP-CO2:VP_Q_kold ->Right axis variable-1
Boiler_T_out		! Cond. and ORC:Boiler_T_out ->Right axis variable-2
Load_MWh_pr_year		! Heat-load:Load_MWh_pr_year ->Right axis variable-3
GAF_ratio		! Heat-load:GAF_ratio ->Right axis variable-4
Load_m		! Heat-load:Load_m ->Right axis variable-5
DegHours_pr_year		! Heat-load:DegHours_pr_year ->Right axis variable-6
GUF_MW		! Heat-load:GUF_MW ->Right axis variable-7
GAF_MW		! Heat-load:GAF_MW ->Right axis variable-8
88,1 		! DegDays:Output 1 ->Right axis variable-9
load_Q		! MW-prod.:load_Q ->Right axis variable-10
*** INITIAL INPUT VALUES
VP_varm_T_ud VP_varm_m VP_kold_T_ud VP_kold_m Varmepumpe_ON VP_P_kW
VP_P_kJ_pr_h VP_P VP_COP_varm VP_Q_varm VP_Q_kold Boiler_T_out MWh_pr_year
GAF Load_m DegDays_avg GUF_MW GAF_MW DegDays load_Q 
LABELS  3
"Temperatures"
"Heat transfer rates"
"CO2 heat pump"
*------------------------------------------------------------------------------
*
* EQUATIONS "Advansed"
* 
EQUATIONS 2
HX_5_m = 70000 * max( 0 , min( 1 ,  ( [103,1] - [80,3] - 5 ) / 2 ) )
HX_6_m = ( 70000 - HX_5_m ) * max( 0 , min( 1 ,  ( [80,4] - [80,3] - 5 ) / 2 ) )
*$UNIT_NAME Advansed
*$LAYER Controls
*$POSITION 153 360
*
*------------------------------------------------------------------------------
*
*
* EQUATIONS "MW-stores"
* 
EQUATIONS 12
s1_l1_Q = 0! s1_l1_m * cp_water * ( s1_l1_Tout - s1_l1_Tin ) / 3.6e6
s1_l2_Q = 0! s1_l2_m * cp_water * ( s1_l2_Tout - s1_l2_Tin ) / 3.6e6
s1_l3_Q = 0! s1_l3_m * cp_water * ( s1_l3_Tout - s1_l3_Tin ) / 3.6e6
s2_l1_Q = [52,2] * cp_water * ( [52,1] - HX3_CS_T_out ) / 3.6e6
s2_l2_Q = [52,7] * cp_water * ( [52,6] - HX6_WS_T_out ) / 3.6e6
s2_l3_Q = [52,12] * cp_water * ( [52,11] - VP_kold_T_ud ) / 3.6e6
s2_l4_Q = [52,17] * cp_water * ( [52,16] - Dummy ) / 3.6e6
s3_l1_Q = [72,2] * cp_water * ( [72,1] - [97,1] ) / 3.6e6
s3_l2_Q = [72,4] * cp_water * ( [72,3] - [97,3] ) / 3.6e6
s3_l3_Q = [72,6] * cp_water * ( [72,5] - [86,1] ) / 3.6e6
s3_l4_Q = [72,8] * cp_water * ( [72,7] - [101,1] ) / 3.6e6
s3_l5_Q = [72,10] * cp_water * ( [72,9] - ORC_T_out ) / 3.6e6
*$UNIT_NAME MW-stores
*$LAYER BTES
*$POSITION 583 61
*
*------------------------------------------------------------------------------
*
*
* EQUATIONS "Cost-function"
* 
EQUATIONS 2
Operational_costs = colls * 7.5  + woodchips * cost_woodchip_perMWH  + heatpumps_e * cost_HP_perMWH  + biooil * cost_biooil_perMWH
Heat_price = ( Operational_costs + Financial_costs ) / Load_MWh_pr_year
*$UNIT_NAME Cost-function
*$LAYER BTES
*$POSITION 754 611
*
*------------------------------------------------------------------------------
*
*
* Model "75.000 m3" (Type 342)
* 
*
UNIT 52 TYPE 342	 75.000 m3
*$UNIT_NAME 75.000 m3
*$MODEL \Trnsys16_1\Studio\Proformas\nostand\XST\TYPE342.tmf
*$POSITION 145 459
*$LAYER Storages # 
PARAMETERS 58
0		! 1 imode
nrsegment		! 2 segments
1		! 3 iconv
4		! 4 Nflow
0		! 5 NPin-1
1		! 6 NPout-1
11		! 7 Joutj-1
0		! 8 NPin-2
1		! 9 NPout-2
1		! 10 Joutj-2
0		! 11 NPin-3
1		! 12 NPout-3
6		! 13 Joutj-3
0		! 14 NPin-4
1		! 15 NPout-4
11		! 16 Joutj-4
V_pit		! 17 Volumne
h_pit		! 18 Height
0		! 19 Top Depth
2.3		! 20 Storage Conductivity
4096		! 21 Storage Heat Capacity
0.000001		! 22 Minimum Velocity
10000000		! 23 Max Flowrate
cp_water		! 24 Fluid Heat Capacity
980		! 25 Fluid Density
0		! 26 Dispersion Length
1		! 27 Darcy Exponent
Thick_insu_pit		! 28 Insulation Thickness
1		! 29 Top Fraction
0		! 30 Side Fraction
0		! 31 Bottom Fraction
Lamda_insu_pit		! 32 Insulation Conductivity
3		! 33 Number of Years
200		! 34 Max Temperature
10		! 35 Initial Storage Temp
8		! 36 Initial Ground Temp
0.03		! 37 Init. Thermal Gradient
0		! 38 No of Preheat Cycles
0		! 39 Max Preheat Temp
0		! 40 Min Preheat Temp
0		! 41 Preheat Phase Time
10		! 42 Average Annual Air Temp
20		! 43 Temp Ampitude
365		! 44 Air Temp Phase Time
1		! 45 Layers
8.28		! 46 Layer Conductivity
2300		! 47 Layer Heat Capacity
100		! 48 Layer Thickness
1		! 49 iPRT
0		! 50 oPRT
50		! 51 LUW
0		! 52 IP1
0		! 53 Print Time Interval 1
0		! 54 IP2
0		! 55 Print Time INterval 2
0		! 56 IP3
0		! 57 Print Time Interval 3
0		! 58 NT
INPUTS 9
HX3_CS_T_out		! HX-3:HX3_CS_T_out ->Inlet Fluid Temperature-1
HX3_CS_m_out		! HX-3:HX3_CS_m_out ->Inlet Mass Flowrate-1
HX6_WS_T_out		! HX-6:HX6_WS_T_out ->Inlet Fluid Temperature-2
HX6_WS_m_out		! HX-6:HX6_WS_m_out ->Inlet Mass Flowrate-2
VP_kold_T_ud		! HP-CO2:VP_kold_T_ud ->Inlet Fluid Temperature-3
VP_kold_m		! HP-CO2:VP_kold_m ->Inlet Mass Flowrate-3
HX7_CS_T_out		! HX-7:HX7_CS_T_out ->Inlet Fluid Temperature-4
HX7_CS_m_out		! HX-7:HX7_CS_m_out ->Inlet Mass Flowrate-4
T_ambient		! Global:T_ambient ->Ambient Temperature
*** INITIAL INPUT VALUES
40 1 40 1 40 1 40 1 10 
*** External files
ASSIGN "***.TYPE142out" 50
*|? name of output file for iPRT and/or oPRT special printing |1000
*------------------------------------------------------------------------------
*
* Model "Biooil" (Type 6)
* 
*
UNIT 58 TYPE 6	 Biooil
*$UNIT_NAME Biooil
*$MODEL .\HVAC\Auxiliary Heaters\Type6.tmf
*$POSITION 614 701
*$LAYER Water Loop # 
PARAMETERS 4
Biooil_Qmax_kJ_per_h		! 1 Maximum heating rate
cp_water		! 2 Specific heat of fluid
0.0		! 3 Overall loss coefficient for heater during operation
1.0		! 4 Efficiency of auxiliary heater
INPUTS 5
37,1 		! Tee-1:Outlet temperature ->Inlet fluid temperature
37,2 		! Tee-1:Outlet flow rate ->Fluid mass flow rate
0,0		! [unconnected] Control Function
T_forward		! Global:T_forward ->Set point temperature
0,0		! [unconnected] Temperature of surroundings
*** INITIAL INPUT VALUES
20.0 100.0 1 60.0 20.0 
*------------------------------------------------------------------------------
*
* Model "2.100 m3" (Type 340)
* 
*
UNIT 72 TYPE 340	 2.100 m3
*$UNIT_NAME 2.100 m3
*$MODEL .\Thermal Storage\Seasonal Storage\type340.tmf
*$POSITION 596 342
*$LAYER Storages # 
*$# Simulates stratified fluid storage with 3
*$# internal heat exchangers, 5 connections
*$# for direct charge and discharge and an
*$# internal electrical heater.
*$# 
*$# 
*$# 
*$# 
*$# 
*$# 
*$# 
*$# 
*$# 
*$# 
*$# 
*$# 
*$# 
*$# 
*$# 
*$# 
*$# 
*$# 
*$# 
*$# 
*$# 
*$# 
*$# 
*$# 
*$# 
*$# 
PARAMETERS 82
H_tank		! 1 storage height
V_tank		! 2 storage volume
cp_water		! 3 spec. heat capacity of the fluid in the storage
992.42		! 4 density of the fliud in the storage
4.49		! 5 effective thermal conductivity in the storage
3		! 6 number of heat exchangers (fixed)
30		! 7 initial temerpature of the whole system
0		! 8 bottom heat loss capacity rate
0		! 9 top heat loss capacity rate
-1		! 10 rel. length of 1. zone
1000		! 11 For 1. Zone heat loss capacity rate from storage to ambient
0		! 12 rel. length of 2. zone
0		! 13 For 2. Zone heat capacity rate from storage to ambient
0		! 14 rel. length of 3. zone
0		! 15 For 3. zone heat capacity rate from storage to ambient
0		! 16 For 4. zone heat capacity rate from storage to ambient
0		! 17 rel. height of inlet postition from doubleport -1
1		! 18 rel. heigth of outlet position from doubleport-1
1		! 19 stratified charging with doubleport(=1)-1
0		! 20 rel. height of inlet postition from doubleport -2
0.5		! 21 rel. heigth of outlet position from doubleport-2
1		! 22 stratified charging with doubleport(=1)-2
1		! 23 rel. height of inlet postition from doubleport -3
0		! 24 rel. heigth of outlet position from doubleport-3
1		! 25 stratified charging with doubleport(=1)-3
0.5		! 26 rel. height of inlet postition from doubleport -4
0		! 27 rel. heigth of outlet position from doubleport-4
1		! 28 stratified charging with doubleport(=1)-4
1		! 29 rel. height of inlet postition from doubleport -5
0		! 30 rel. heigth of outlet position from doubleport-5
1		! 31 stratified charging with doubleport(=1)-5
0		! 32 rel. position of temperature sensor-1
0.25		! 33 rel. position of temperature sensor-2
0.5		! 34 rel. position of temperature sensor-3
0.75		! 35 rel. position of temperature sensor-4
1		! 36 rel. position of temperature sensor-5
0		! 37 auxiliary heater mode
0		! 38 heater install mode
0		! 39 abs. length of auxiliary heater
0.5		! 40 rel. position where aux. heater is installed
0.6		! 41 rel. position fo temperature controller for aux. heater
0		! 42 set temperature of the controller for aux. heater
2		! 43 dead band temperature difference of the controller
-1		! 44 rel. inlet position of the heat exchanger-1
-1		! 45 rel. outlet position of the heat exchanger-1
0.005		! 46 volume of heat exchanger-1
4.18		! 47 spec.heat capacity of the fluid in the heat exchanger-1
992.42		! 48 densitiy of the fluid in the heatexchanger-1
0		! 49 heat transfere capacity rate from the heat exchange to the store-1
0		! 50 1. parameter for the calculation of (UA)*-1
0		! 51 2. parameter for the calculation of (UA)*-1
0.6		! 52 3. parameter for the calculation of (UA)*-1
0		! 53 heat loss capacity rate from the heat exchanger to ambient-1
0		! 54 stratified charging with heat exchanger -1
-1		! 55 rel. inlet position of the heat exchanger-2
-1		! 56 rel. outlet position of the heat exchanger-2
0.005		! 57 volume of heat exchanger-2
4.18		! 58 spec.heat capacity of the fluid in the heat exchanger-2
992.42		! 59 densitiy of the fluid in the heatexchanger-2
0		! 60 heat transfere capacity rate from the heat exchange to the store-2
0		! 61 1. parameter for the calculation of (UA)*-2
0		! 62 2. parameter for the calculation of (UA)*-2
0.6		! 63 3. parameter for the calculation of (UA)*-2
0		! 64 heat loss capacity rate from the heat exchanger to ambient-2
0		! 65 stratified charging with heat exchanger -2
-1		! 66 rel. inlet position of the heat exchanger-3
-1		! 67 rel. outlet position of the heat exchanger-3
0.005		! 68 volume of heat exchanger-3
4.18		! 69 spec.heat capacity of the fluid in the heat exchanger-3
992.42		! 70 densitiy of the fluid in the heatexchanger-3
0		! 71 heat transfere capacity rate from the heat exchange to the store-3
0		! 72 1. parameter for the calculation of (UA)*-3
0		! 73 2. parameter for the calculation of (UA)*-3
0.6		! 74 3. parameter for the calculation of (UA)*-3
0		! 75 heat loss capacity rate from the heat exchanger to ambient-3
0		! 76 stratified charging with heat exchanger -3
0.001		! 77 accuracy for calculating the temperatures
1		! 78 accuracy for temperature dependency of (UA)* (%)
10		! 79 precision fo the mixing process in the store
0		! 80 flag, if the temperature-dependence timestep control is used (1=yes)
nrtanknodes		! 81 number of nodes for the storage 
0		! 82 not used
INPUTS 18
97,1 		! Shunt-2:Temperature at outlet 1 ->inlet temperature of doubleport-1
Positive_1		! Positive:Positive_1 ->fluid flow rate of doubleport-1
97,3 		! Shunt-2:Temperature at outlet 2 ->inlet temperature of doubleport-2
Positive_2		! Positive:Positive_2 ->fluid flow rate of doubleport-2
86,1 		! T-high:Outlet temperature ->inlet temperature of doubleport-3
86,2 		! T-high:Outlet flow rate ->fluid flow rate of doubleport-3
101,1 		! T-mid-3:Outlet temperature ->inlet temperature of doubleport-4
101,2 		! T-mid-3:Outlet flow rate ->fluid flow rate of doubleport-4
ORC_T_out		! Cond. and ORC:ORC_T_out ->inlet temperature of doubleport-5
ORC_m_out		! Cond. and ORC:ORC_m_out ->fluid flow rate of doubleport-5
0,0		! [unconnected] inlet temperature of heatexchanger-1
0,0		! [unconnected] fluid flow rate of heat exchanger-1
0,0		! [unconnected] inlet temperature of heatexchanger-2
0,0		! [unconnected] fluid flow rate of heat exchanger-2
0,0		! [unconnected] inlet temperature of heatexchanger-3
0,0		! [unconnected] fluid flow rate of heat exchanger-3
T_ambient		! Global:T_ambient ->ambient temperature
0,0		! [unconnected] auxiliary heater input
*** INITIAL INPUT VALUES
20 0 20 0 20 0 20 0 20 0 20 0 20 0 20 0 15 0 
*------------------------------------------------------------------------------
*
* Model "Shunt-1" (Type 11)
* 
*
UNIT 39 TYPE 11	 Shunt-1
*$UNIT_NAME Shunt-1
*$MODEL .\Hydronics\Tempering Valve\Other Fluids\Type11b.tmf
*$POSITION 430 657
*$LAYER Water Loop # 
PARAMETERS 2
4		! 1 Tempering valve mode
7		! 2 Nb. of oscillations allowed
INPUTS 4
T_return		! Global:T_return ->Inlet temperature
Load_m		! Heat-load:Load_m ->Inlet flow rate
79,1 		! Tee-H:Outlet temperature ->Heat source temperature
T_forward		! Global:T_forward ->Set point temperature
*** INITIAL INPUT VALUES
20.0 100.0 55.0 0 
*------------------------------------------------------------------------------
*
* EQUATIONS "MW-prod."
* 
EQUATIONS 12
coll1_Q = [3,2] * cp_glycol * ( [3,1] - HX1_WS_T_out ) / 3.6e6
coll2_Q = [47,2] * cp_glycol * ( [47,1] - HX2_WS_T_out ) / 3.6e6
coll3_Q = [54,2] * cp_glycol * ( [54,1] - HX3_WS_T_out ) / 3.6e6
hp1_cs_Q = 0! hp1_cs_m * cp_water * ( hp1_cs_Tout - hp1_cs_Tin ) / 3.6e6
hp1_ws_Q = 0! hp1_ws_m * cp_water * ( hp1_ws_Tout - hp1_ws_Tin ) / 3.6e6
hp2_cs_Q = VP_kold_m * cp_water * ( VP_kold_T_ud - [52,11] ) / 3.6e6
hp2_ws_Q = VP_varm_m * cp_water * ( VP_varm_T_ud - [75,3] ) / 3.6e6
ORC_Q_ = ORC_m_out * cp_water * ( ORC_T_out - [72,9] ) / 3.6e6
ECO_Q_ = Boiler_m_out * cp_water * ( Boiler_T_out - [75,1] ) / 3.6e6
load_Q = [37,2] * cp_water * ( T_return - T_forward ) / 3.6e6
prod_Q = [37,2] * cp_water * ( T_return - [37,1] ) / 3.6e6
Biooil_Q = [58,5] / 3.6e6
*$UNIT_NAME MW-prod.
*$LAYER BTES
*$POSITION 709 50
*
*------------------------------------------------------------------------------
*
*
* EQUATIONS "HX-1"
* 
EQUATIONS 5
HX1_WS_T_out = [96,1] + HX1_DT
HX1_WS_m_out = [3,2]
HX1_CS_T_out = [3,1] - HX1_DT
HX1_CS_m_out = [3,2] * cp_glycol / cp_water
HX1_DT = 3
*$UNIT_NAME HX-1
*$LAYER Water Loop
*$POSITION -97 141
*
*------------------------------------------------------------------------------
*
*
* Model "Type24" (Type 24)
* 
*
UNIT 40 TYPE 24	 Type24
*$UNIT_NAME Type24
*$MODEL .\Utility\Integrators\Quantity Integrator\Type24.tmf
*$POSITION -25 694
*$LAYER BTES # 
PARAMETERS 2
8760		! 1 Integration period
0		! 2 Relative or absolute start time
INPUTS 26
coll1_Q		! MW-prod.:coll1_Q ->Input to be integrated-1
coll2_Q		! MW-prod.:coll2_Q ->Input to be integrated-2
coll3_Q		! MW-prod.:coll3_Q ->Input to be integrated-3
hp1_cs_Q		! MW-prod.:hp1_cs_Q ->Input to be integrated-4
hp1_ws_Q		! MW-prod.:hp1_ws_Q ->Input to be integrated-5
hp2_cs_Q		! MW-prod.:hp2_cs_Q ->Input to be integrated-6
hp2_ws_Q		! MW-prod.:hp2_ws_Q ->Input to be integrated-7
ORC_Q_		! MW-prod.:ORC_Q_ ->Input to be integrated-8
ECO_Q_		! MW-prod.:ECO_Q_ ->Input to be integrated-9
load_Q		! MW-prod.:load_Q ->Input to be integrated-10
prod_Q		! MW-prod.:prod_Q ->Input to be integrated-11
s1_l1_Q		! MW-stores:s1_l1_Q ->Input to be integrated-12
s1_l2_Q		! MW-stores:s1_l2_Q ->Input to be integrated-13
s1_l3_Q		! MW-stores:s1_l3_Q ->Input to be integrated-14
s2_l1_Q		! MW-stores:s2_l1_Q ->Input to be integrated-15
s2_l2_Q		! MW-stores:s2_l2_Q ->Input to be integrated-16
s2_l3_Q		! MW-stores:s2_l3_Q ->Input to be integrated-17
s2_l4_Q		! MW-stores:s2_l4_Q ->Input to be integrated-18
s3_l1_Q		! MW-stores:s3_l1_Q ->Input to be integrated-19
s3_l2_Q		! MW-stores:s3_l2_Q ->Input to be integrated-20
s3_l3_Q		! MW-stores:s3_l3_Q ->Input to be integrated-21
s3_l4_Q		! MW-stores:s3_l4_Q ->Input to be integrated-22
s3_l5_Q		! MW-stores:s3_l5_Q ->Input to be integrated-23
VP_ON		! HP-CO2:VP_ON ->Input to be integrated-24
Biooil_Q		! MW-prod.:Biooil_Q ->Input to be integrated-25
shadow_rad_total		! Shadow:shadow_rad_total ->Input to be integrated-26
*** INITIAL INPUT VALUES
0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
0.0 0.0 0.0 0.0 0.0 0.0 
*------------------------------------------------------------------------------
*
* EQUATIONS "Pump-1"
* 
EQUATIONS 8
Coll1_DT_out = 5
Coll1_T_out_min = 33
Coll1_T_out = max( Coll1_T_out_min , [64,1] + Coll1_DT_out )
Coll1_DT = ( [64,1] + Coll1_T_out ) / 2 - T_ambient
Coll1_m = Coll1_area / cp_glycol / max( 1 , Coll1_T_out - [64,1] )  * ( shadow_rad_total * coll1_eta0  - coll1_a1 * Coll1_DT - coll1_a2 * Coll1_DT^2 )
Pump_1_max = 180 * 1000 * cp_water / cp_glycol
Pump_1_min = Pump_1_max * 0.15
Pump_1_m = max( 1e-6 ,  max( Pump_1_min , min( Pump_1_max , Coll1_m ) )  * gt( Coll1_m , Pump_1_min ) )
*$UNIT_NAME Pump-1
*$LAYER Water Loop
*$POSITION -172 238
*
*------------------------------------------------------------------------------
*
*
* EQUATIONS "Pump-2"
* 
EQUATIONS 8
Coll2_DT_out = 5
Coll2_T_out_min = 25
Coll2_T_out = max( Coll2_T_out_min , [64,2] + Coll2_DT_out )
Coll2_DT = ( [64,2] + Coll2_T_out ) / 2 - T_ambient
Coll2_m = Coll2_area / cp_glycol / max( 1 , Coll2_T_out - [64,2] )  * ( shadow_rad_total * coll2_eta0  - coll2_a1 * Coll2_DT - coll2_a2 * Coll2_DT^2 )
Pump_2_max = 200 * 1000 * cp_water / cp_glycol
Pump_2_min = Pump_2_max * 0.15
Pump_2_m = max( 1e-6 ,  max( Pump_2_min , min( Pump_2_max , Coll2_m ) )  * gt( Coll2_m , Pump_2_min ) )
*$UNIT_NAME Pump-2
*$LAYER Water Loop
*$POSITION -172 382
*
*------------------------------------------------------------------------------
*
*
* EQUATIONS "Pump-3"
* 
EQUATIONS 8
Coll3_DT_out = 5
Coll3_T_out_min = 20
Coll3_T_out = max( Coll3_T_out_min , [64,3] + Coll3_DT_out )
Coll3_DT = ( [64,3] + Coll3_T_out ) / 2 - T_ambient
Coll3_m = Coll3_area / cp_glycol / max( 1 , Coll3_T_out - [64,3] )  * ( shadow_rad_total * coll3_eta0  - coll3_a1 * Coll3_DT - coll3_a2 * Coll3_DT^2 )
Pump_3_max = 300 * 1000 * cp_water / cp_glycol
Pump_3_min = Pump_3_max * 0.15
Pump_3_m = max( 1e-6 ,  max( Pump_3_min , min( Pump_3_max , Coll3_m ) )  * gt( Coll3_m , Pump_3_min ) )
*$UNIT_NAME Pump-3
*$LAYER Water Loop
*$POSITION -172 526
*
*------------------------------------------------------------------------------
*
*
* EQUATIONS "HX-2"
* 
EQUATIONS 5
HX2_WS_T_out = [96,1] + HX2_DT
HX2_WS_m_out = [47,2]
HX2_CS_T_out = [47,1] - HX2_DT
HX2_CS_m_out = [47,2] * cp_glycol / cp_water
HX2_DT = 3
*$UNIT_NAME HX-2
*$LAYER Water Loop
*$POSITION -67 319
*
*------------------------------------------------------------------------------
*
*
* EQUATIONS "HX-3"
* 
EQUATIONS 5
HX3_WS_T_out = [52,1] + HX3_DT
HX3_WS_m_out = [54,2]
HX3_CS_T_out = [54,1] - HX3_DT
HX3_CS_m_out = [54,2] * cp_glycol / cp_water
HX3_DT = 3
*$UNIT_NAME HX-3
*$LAYER Water Loop
*$POSITION -67 463
*
*------------------------------------------------------------------------------
*
*
* EQUATIONS "HX-6"
* 
EQUATIONS 5
HX6_WS_T_out = [96,1] + HX6_DT
HX6_WS_m_out = HX_6_m
HX6_CS_T_out = [52,6] - HX6_DT
HX6_CS_m_out = HX_6_m
HX6_DT = 3
*$UNIT_NAME HX-6
*$LAYER Water Loop
*$POSITION 294 477
*
*------------------------------------------------------------------------------
*
*
* Model "Annual" (Type 25)
* 
*
UNIT 44 TYPE 25	 Annual
*$UNIT_NAME Annual
*$MODEL .\Output\Printer\User-Supplied Units\Type25b.tmf
*$POSITION 64 697
*$LAYER Outputs # 
PARAMETERS 10
8760		! 1 Printing interval
0		! 2 Start time
STOP		! 3 Stop time
34		! 4 Logical unit
1		! 5 Units printing mode
0		! 6 Relative or absolute start time
-1		! 7 Overwrite or Append
1		! 8 Print header
0		! 9 Delimiter
1		! 10 Print labels
INPUTS 28
40,1 		! Type24:Result of integration-1 ->Input to be printed-1
40,2 		! Type24:Result of integration-2 ->Input to be printed-2
40,3 		! Type24:Result of integration-3 ->Input to be printed-3
40,4 		! Type24:Result of integration-4 ->Input to be printed-4
40,5 		! Type24:Result of integration-5 ->Input to be printed-5
40,6 		! Type24:Result of integration-6 ->Input to be printed-6
40,7 		! Type24:Result of integration-7 ->Input to be printed-7
40,8 		! Type24:Result of integration-8 ->Input to be printed-8
40,9 		! Type24:Result of integration-9 ->Input to be printed-9
40,10 		! Type24:Result of integration-10 ->Input to be printed-10
40,11 		! Type24:Result of integration-11 ->Input to be printed-11
0,0		! [unconnected] Input to be printed-12
0,0		! [unconnected] Input to be printed-13
0,0		! [unconnected] Input to be printed-14
0,0		! [unconnected] Input to be printed-15
0,0		! [unconnected] Input to be printed-16
0,0		! [unconnected] Input to be printed-17
0,0		! [unconnected] Input to be printed-18
0,0		! [unconnected] Input to be printed-19
0,0		! [unconnected] Input to be printed-20
0,0		! [unconnected] Input to be printed-21
0,0		! [unconnected] Input to be printed-22
0,0		! [unconnected] Input to be printed-23
40,24 		! Type24:Result of integration-24 ->Input to be printed-24
40,25 		! Type24:Result of integration-25 ->Input to be printed-25
Heat_price		! Cost-function:Heat_price ->Input to be printed-26
Total_sol_MWh		! Summa:Total_sol_MWh ->Input to be printed-27
Investment_total		! Investment:Investment_total ->Input to be printed-28
*** INITIAL INPUT VALUES
coll1 coll2 coll3 hp1_cs hp1_ws hp2_cs hp2_ws ORC ECO load prod_nobackup
s1_l1 s1_l2 s1_l3 s2_l1 s2_l2 s2_l3 s2_l4 s3_l1 s3_l2 s3_l3 s3_l4 s3_l5
hp2_ON Biooil LCOH_heatprice Total_sol Investment 
MWh MWh MWh MWh MWh MWh MWh MWh MWh MWh MWh MWh MWh MWh MWh MWh MWh MWh MWh MWh MWh MWh MWh hours MWh DKK/MWh MWh/m2 DKK
*** External files
ASSIGN "***.txt" 34
*|? Output file for printed results |1000
*------------------------------------------------------------------------------
*
* Model "Delay-3" (Type 93)
* 
*
UNIT 80 TYPE 93	 Delay-3
*$UNIT_NAME Delay-3
*$MODEL .\Utility\Input Value Recall\Type93.tmf
*$POSITION 381 516
*$LAYER Controls # 
PARAMETERS 2
4		! 1 Number of inputs to be stored
1		! 2 Number of timesteps to be stored
INPUTS 4
52,11 		! 75.000 m3:Fluid Temp 1-3 ->Input value-1
72,29 		! 2.100 m3:temperature at sensor-1 ->Input value-2
72,33 		! 2.100 m3:temperature at sensor-5 ->Input value-3
52,6 		! 75.000 m3:Fluid Temp 1-2 ->Input value-4
*** INITIAL INPUT VALUES
0 0 0 0 
*------------------------------------------------------------------------------
*
* EQUATIONS "HP-CO2"
* 
EQUATIONS 14
VP_varm_T_ud = min( 80 , T_forward )
VP_varm_m = VP_Q_varm / cp_water / max( 1 , VP_varm_T_ud - [75,3] )
VP_kold_T_ud = max( 5 , min( 20 , [52,11] - 5 ) )
VP_kold_m = VP_Q_kold / cp_water / max( 1 , [52,11] - VP_kold_T_ud )
VP_H_control = VP_varm_m / max( 1 , [39,2] )
VP_ON = lt( mod( time , 24 ) , 12 + 1000 ) * 0.5  * ( gt( mod( time , 8760 ) , Heat_pump_2_start )  + lt( mod( time , 8760 ), Heat_pump_2_stop ) )
VP_P_kW = Heatpump_P_kW
VP_P_kJ_pr_h = VP_P_kW * 3600 * VP_ON  * max( 0 , min( 1 , ( [80,1] - 5 ) / 10 ) )  * max( 0 , min( 1 , ( 45 - [75,3] ) / 5 ) )
VP_COP_varm = 2.81  + max( 0-1 , min( 1 , ( 40 - [75,3] ) / 20 ) )  + max( 0-1 , min( 0 , ( [80,1] - 20 ) / 20 ) )
VP_Q_varm_nom = VP_P_kJ_pr_h * VP_COP_varm
VP_Q_varm_max = [39,2] * cp_water * ( VP_varm_T_ud - [75,3] )
VP_Q_varm = min( VP_Q_varm_nom , VP_Q_varm_max )
VP_P = VP_Q_varm / VP_COP_varm
VP_Q_kold = VP_Q_varm - VP_P
*$UNIT_NAME HP-CO2
*$LAYER Water Loop
*$POSITION 259 575
*
*------------------------------------------------------------------------------
*
*
* EQUATIONS "HX-7"
* 
EQUATIONS 5
HX7_WS_T_out = [52,16] + HX7_DT
HX7_WS_m_out = [83,4]
HX7_CS_T_out = [83,3] - HX7_DT
HX7_CS_m_out = [83,4]
HX7_DT = 3
*$UNIT_NAME HX-7
*$LAYER Main
*$POSITION 269 381
*
*------------------------------------------------------------------------------
*
*
* Model "PTES-hourly" (Type 25)
* 
*
UNIT 61 TYPE 25	 PTES-hourly
*$UNIT_NAME PTES-hourly
*$MODEL .\Output\Printer\User-Supplied Units\Type25b.tmf
*$POSITION 158 704
*$LAYER Main # 
PARAMETERS 10
1		! 1 Printing interval
8760		! 2 Start time
STOP		! 3 Stop time
38		! 4 Logical unit
1		! 5 Units printing mode
0		! 6 Relative or absolute start time
-1		! 7 Overwrite or Append
1		! 8 Print header
0		! 9 Delimiter
1		! 10 Print labels
INPUTS 19
52,1 		! 75.000 m3:Fluid Temp 1-1 ->Input to be printed-1
52,2 		! 75.000 m3:Mass Flowrate 1-1 ->Input to be printed-2
52,3 		! 75.000 m3:Thermal Power 1-1 ->Input to be printed-3
52,6 		! 75.000 m3:Fluid Temp 1-2 ->Input to be printed-4
52,7 		! 75.000 m3:Mass Flowrate 1-2 ->Input to be printed-5
52,8 		! 75.000 m3:Thermal Power 1-2 ->Input to be printed-6
52,11 		! 75.000 m3:Fluid Temp 1-3 ->Input to be printed-7
52,12 		! 75.000 m3:Mass Flowrate 1-3 ->Input to be printed-8
52,13 		! 75.000 m3:Thermal Power 1-3 ->Input to be printed-9
52,16 		! 75.000 m3:Fluid Temp 1-4 ->Input to be printed-10
52,17 		! 75.000 m3:Mass Flowrate 1-4 ->Input to be printed-11
52,18 		! 75.000 m3:Thermal Power 1-4 ->Input to be printed-12
52,22 		! 75.000 m3:Ave Storage Temp ->Input to be printed-13
52,24 		! 75.000 m3:Top Losses ->Input to be printed-14
52,25 		! 75.000 m3:Side Losses ->Input to be printed-15
52,26 		! 75.000 m3:Bottom Losses ->Input to be printed-16
52,27 		! 75.000 m3:Energy Change ->Input to be printed-17
52,21 		! 75.000 m3:Max Storage Temp ->Input to be printed-18
52,23 		! 75.000 m3:Min Storage Temp ->Input to be printed-19
*** INITIAL INPUT VALUES
Flow_T_port_1 Massflow_port_1 Power_port_1 Flow_T_port_2 Masflow_port_2
Power_port_2 Flow_T_port_3 Massflow_port_3 Power_port_3 Flow_T_port_4
Massflow_port_4 Power_port_4 Average_T Top_loss Side_loss Bot_loss
Energy_change Max_temperature Min_temperature 
C kg/hr kJ/hr C kg/hr kJ/hr C kg/hr kJ/hr C kg/hr kJ/hr C kJ kJ kJ kJ C C
*** External files
ASSIGN "PTES.txt" 38
*|? Output file for printed results |1000
*------------------------------------------------------------------------------
*
* EQUATIONS "Simple"
* 
EQUATIONS 5
Simple_A_control = HX2_CS_m_out / max( 1e-6 , HX1_CS_m_out + HX2_CS_m_out )
Simple_C_control = max( 0 , min( 1 , ( 80 - HX1_CS_T_out ) / 10 ) )
Simple_D_control = 0! max( 0 , min( 1 , ( 80 - Simple_D_T ) / 10 ) )
Simple_G_control = max( 0 , min( 1 , ( 80 - HX6_CS_T_out ) / 10 ) )
Shunt_2_control = max( 0 , min ( 1 , ( [72,1] - T_forward )/ max( 1 , [72,1] - [72,3] ) ) )
*$UNIT_NAME Simple
*$LAYER Controls
*$POSITION 58 360
*
*------------------------------------------------------------------------------
*
*
* EQUATIONS "Cond. and ORC"
* 
EQUATIONS 15
Boiler_T_out = [75,1]
Boiler_m_out = [75,2]
ORC_T_out = max( T_forward + 5 , [72,9] + 20 )
ORC_m_out = ORC_Q / cp_water / max( 1 , ORC_T_out - [72,9] )
ORC_Q_kW = Boiler_ORC_Q_kW  !3200 * 0.98 + 234 + 1123
ORC_Q = ORC_Q_kW * 3600 * Part_load
Boiler_ON = gt( mod( time , 8760 ) , Boiler_start )  + lt( mod( time , 8760 ) , Boiler_stop )
ORC_T_limit_100 = 6450 + 250 - 2000
ORC_T_limit = ORC_T_limit_100 / 100
Part_load = Boiler_ON  * 1  * max( 0 , min( 1 , ( ORC_T_limit - [72,9] ) / 5 ) )
Part_load_100 = Part_load * 100
PL1 = Boiler_ON  +1
PL2 = -1
PL3 = max( 0 , min( 1 , ( ORC_T_limit - [72,9] ) / 5 ) )  +5
Boiler_DT = 8 + 8
*$UNIT_NAME Cond. and ORC
*$LAYER Water Loop
*$POSITION 419 495
*
*------------------------------------------------------------------------------
*
*
* Model "Tee-CDG" (Type 11)
* 
*
UNIT 96 TYPE 11	 Tee-CDG
*$UNIT_NAME Tee-CDG
*$MODEL .\Hydronics\Tee-Piece\Other Fluids\Type11h.tmf
*$POSITION 505 402
*$LAYER Water Loop # 
PARAMETERS 1
1		! 1 Tee piece mode
INPUTS 4
72,5 		! 2.100 m3:outlet temperature of doubleport-3 ->Temperature at inlet 1
72,6 		! 2.100 m3:fluid flow rate of double port-3 ->Flow rate at inlet 1
72,7 		! 2.100 m3:outlet temperature of doubleport-4 ->Temperature at inlet 2
72,8 		! 2.100 m3:fluid flow rate of double port-4 ->Flow rate at inlet 2
*** INITIAL INPUT VALUES
20.0 100.0 20.0 100.0 
*------------------------------------------------------------------------------
*
* Model "Tee-2" (Type 11)
* 
*
UNIT 63 TYPE 11	 Tee-2
*$UNIT_NAME Tee-2
*$MODEL .\Hydronics\Tee-Piece\Other Fluids\Type11h.tmf
*$POSITION 668 514
*$LAYER Water Loop # 
PARAMETERS 1
1		! 1 Tee piece mode
INPUTS 4
72,1 		! 2.100 m3:outlet temperature of doubleport-1 ->Temperature at inlet 1
72,2 		! 2.100 m3:fluid flow rate of double port-1 ->Flow rate at inlet 1
72,3 		! 2.100 m3:outlet temperature of doubleport-2 ->Temperature at inlet 2
72,4 		! 2.100 m3:fluid flow rate of double port-2 ->Flow rate at inlet 2
*** INITIAL INPUT VALUES
20.0 100.0 20.0 100.0 
*------------------------------------------------------------------------------
*
* Model "DH-Temp" (Type 65)
* 
*
UNIT 98 TYPE 65	 DH-Temp
*$UNIT_NAME DH-Temp
*$MODEL .\Output\Online Plotter\Online Plotter Without File\Type65d.tmf
*$POSITION 725 384
*$LAYER Outputs # 
PARAMETERS 12
10		! 1 Nb. of left-axis variables
10		! 2 Nb. of right-axis variables
0.0		! 3 Left axis minimum
100		! 4 Left axis maximum
0.0		! 5 Right axis minimum
100		! 6 Right axis maximum
1		! 7 Number of plots per simulation
12		! 8 X-axis gridpoints
0		! 9 Shut off Online w/o removing
-1		! 10 Logical unit for output file
0		! 11 Output file units
0		! 12 Output file delimiter
INPUTS 20
39,1 		! Shunt-1:Temperature at outlet 1 ->Left axis variable-1
39,3 		! Shunt-1:Temperature at outlet 2 ->Left axis variable-2
75,1 		! Div-H:Temperature at outlet 1 ->Left axis variable-3
75,3 		! Div-H:Temperature at outlet 2 ->Left axis variable-4
Boiler_T_out		! Cond. and ORC:Boiler_T_out ->Left axis variable-5
ORC_T_out		! Cond. and ORC:ORC_T_out ->Left axis variable-6
97,1 		! Shunt-2:Temperature at outlet 1 ->Left axis variable-7
97,3 		! Shunt-2:Temperature at outlet 2 ->Left axis variable-8
0,0		! [unconnected] Left axis variable-9
96,2 		! Tee-CDG:Outlet flow rate ->Left axis variable-10
72,1 		! 2.100 m3:outlet temperature of doubleport-1 ->Right axis variable-1
72,3 		! 2.100 m3:outlet temperature of doubleport-2 ->Right axis variable-2
63,1 		! Tee-2:Outlet temperature ->Right axis variable-3
VP_varm_T_ud		! HP-CO2:VP_varm_T_ud ->Right axis variable-4
VP_kold_T_ud		! HP-CO2:VP_kold_T_ud ->Right axis variable-5
79,1 		! Tee-H:Outlet temperature ->Right axis variable-6
37,1 		! Tee-1:Outlet temperature ->Right axis variable-7
0,0		! [unconnected] Right axis variable-8
0,0		! [unconnected] Right axis variable-9
0,0		! [unconnected] Right axis variable-10
*** INITIAL INPUT VALUES
Shunt-1_1 Shunt-1_2 Div-H_1 Div-H_2 Boiler_T_out ORC_T_out Shunt-2_1
Shunt-2_2 From_coll_1_2 From_store_2 dp_1 dp_2 Tee-2 VP_varm_T_ud VP_kold_T_ud
Tee-H Tee-1 label label label 
LABELS  3
"Temperatures"
"Heat transfer rates"
"DH temperatures"
*------------------------------------------------------------------------------
*
* Model "Div-H" (Type 11)
* 
*
UNIT 75 TYPE 11	 Div-H
*$UNIT_NAME Div-H
*$MODEL .\Hydronics\Flow Diverter\Other Fluids\Type11f.tmf
*$POSITION 428 595
*$LAYER Water Loop # 
PARAMETERS 1
2		! 1 Controlled flow diverter mode
INPUTS 3
39,1 		! Shunt-1:Temperature at outlet 1 ->Inlet temperature
39,2 		! Shunt-1:Flowrate at outlet 1 ->Inlet flow rate
VP_H_control		! HP-CO2:VP_H_control ->Control signal
*** INITIAL INPUT VALUES
20.0 100.0 0.5 
*------------------------------------------------------------------------------
*
* Model "Tee-1" (Type 11)
* 
*
UNIT 37 TYPE 11	 Tee-1
*$UNIT_NAME Tee-1
*$MODEL .\Hydronics\Tee-Piece\Other Fluids\Type11h.tmf
*$POSITION 675 657
*$LAYER Water Loop # 
PARAMETERS 1
1		! 1 Tee piece mode
INPUTS 4
79,1 		! Tee-H:Outlet temperature ->Temperature at inlet 1
79,2 		! Tee-H:Outlet flow rate ->Flow rate at inlet 1
39,3 		! Shunt-1:Temperature at outlet 2 ->Temperature at inlet 2
39,4 		! Shunt-1:Flow rate at outlet 2 ->Flow rate at inlet 2
*** INITIAL INPUT VALUES
20.0 100.0 20.0 100.0 
*------------------------------------------------------------------------------
*
* Model "Delay-2" (Type 93)
* 
*
UNIT 64 TYPE 93	 Delay-2
*$UNIT_NAME Delay-2
*$MODEL .\Utility\Input Value Recall\Type93.tmf
*$POSITION -80 382
*$LAYER Controls # 
PARAMETERS 2
3		! 1 Number of inputs to be stored
1		! 2 Number of timesteps to be stored
INPUTS 3
HX1_WS_T_out		! HX-1:HX1_WS_T_out ->Input value-1
HX2_WS_T_out		! HX-2:HX2_WS_T_out ->Input value-2
HX3_WS_T_out		! HX-3:HX3_WS_T_out ->Input value-3
*** INITIAL INPUT VALUES
0 0 0 
*------------------------------------------------------------------------------
*
* Model "Div-C" (Type 11)
* 
*
UNIT 87 TYPE 11	 Div-C
*$UNIT_NAME Div-C
*$MODEL .\Hydronics\Flow Diverter\Other Fluids\Type11f.tmf
*$POSITION 396 155
*$LAYER Water Loop # 
PARAMETERS 1
2		! 1 Controlled flow diverter mode
INPUTS 3
HX1_CS_T_out		! HX-1:HX1_CS_T_out ->Inlet temperature
HX1_CS_m_out		! HX-1:HX1_CS_m_out ->Inlet flow rate
Simple_C_control		! Simple:Simple_C_control ->Control signal
*** INITIAL INPUT VALUES
20.0 100.0 0.5 
*------------------------------------------------------------------------------
*
* EQUATIONS "Summa"
* 
EQUATIONS 5
colls = [40,1] + [40,2] + [40,3]
heatpumps_e = [40,5] - [40,4] + [40,7] - [40,6]
woodchips = [40,8] + [40,9]
biooil = [40,25]
Total_sol_MWh = [40,26]/3600/1000
*$UNIT_NAME Summa
*$LAYER BTES
*$POSITION 48 573
*
*------------------------------------------------------------------------------
*
*
* Model "Div-D" (Type 11)
* 
*
UNIT 70 TYPE 11	 Div-D
*$UNIT_NAME Div-D
*$MODEL .\Hydronics\Flow Diverter\Other Fluids\Type11f.tmf
*$POSITION 396 222
*$LAYER Water Loop # 
PARAMETERS 1
2		! 1 Controlled flow diverter mode
INPUTS 3
HX2_WS_T_out		! HX-2:HX2_WS_T_out ->Inlet temperature
HX2_WS_m_out		! HX-2:HX2_WS_m_out ->Inlet flow rate
Simple_D_control		! Simple:Simple_D_control ->Control signal
*** INITIAL INPUT VALUES
20.0 100.0 0.5 
*------------------------------------------------------------------------------
*
* Model "Div-G" (Type 11)
* 
*
UNIT 76 TYPE 11	 Div-G
*$UNIT_NAME Div-G
*$MODEL .\Hydronics\Flow Diverter\Other Fluids\Type11f.tmf
*$POSITION 388 421
*$LAYER Water Loop # 
PARAMETERS 1
2		! 1 Controlled flow diverter mode
INPUTS 3
HX6_CS_T_out		! HX-6:HX6_CS_T_out ->Inlet temperature
HX6_CS_m_out		! HX-6:HX6_CS_m_out ->Inlet flow rate
Simple_G_control		! Simple:Simple_G_control ->Control signal
*** INITIAL INPUT VALUES
20.0 100.0 0.5 
*------------------------------------------------------------------------------
*
* Model "Tee-H" (Type 11)
* 
*
UNIT 79 TYPE 11	 Tee-H
*$UNIT_NAME Tee-H
*$MODEL .\Hydronics\Tee-Piece\Other Fluids\Type11h.tmf
*$POSITION 676 575
*$LAYER Water Loop # 
PARAMETERS 1
1		! 1 Tee piece mode
INPUTS 4
83,1 		! Div-A:Temperature at outlet 1 ->Temperature at inlet 1
83,2 		! Div-A:Flow rate at outlet 1 ->Flow rate at inlet 1
VP_varm_T_ud		! HP-CO2:VP_varm_T_ud ->Temperature at inlet 2
VP_varm_m		! HP-CO2:VP_varm_m ->Flow rate at inlet 2
*** INITIAL INPUT VALUES
20.0 100.0 20.0 100.0 
*------------------------------------------------------------------------------
*
* Model "Tee-A" (Type 11)
* 
*
UNIT 90 TYPE 11	 Tee-A
*$UNIT_NAME Tee-A
*$MODEL .\Hydronics\Tee-Piece\Other Fluids\Type11h.tmf
*$POSITION 500 496
*$LAYER Main # 
PARAMETERS 1
1		! 1 Tee piece mode
INPUTS 4
Boiler_T_out		! Cond. and ORC:Boiler_T_out ->Temperature at inlet 1
Boiler_m_out		! Cond. and ORC:Boiler_m_out ->Flow rate at inlet 1
HX7_WS_T_out		! HX-7:HX7_WS_T_out ->Temperature at inlet 2
HX7_WS_m_out		! HX-7:HX7_WS_m_out ->Flow rate at inlet 2
*** INITIAL INPUT VALUES
20.0 100.0 20.0 100.0 
*------------------------------------------------------------------------------
*
* Model "Shunt-2" (Type 11)
* 
*
UNIT 97 TYPE 11	 Shunt-2
*$UNIT_NAME Shunt-2
*$MODEL .\Hydronics\Flow Diverter\Other Fluids\Type11f.tmf
*$POSITION 594 496
*$LAYER Water Loop # 
PARAMETERS 1
2		! 1 Controlled flow diverter mode
INPUTS 3
90,1 		! Tee-A:Outlet temperature ->Inlet temperature
90,2 		! Tee-A:Outlet flow rate ->Inlet flow rate
Shunt_2_control		! Simple:Shunt_2_control ->Control signal
*** INITIAL INPUT VALUES
20.0 100.0 0.5 
*------------------------------------------------------------------------------
*
* Model "ORC" (Type 65)
* 
*
UNIT 91 TYPE 65	 ORC
*$UNIT_NAME ORC
*$MODEL .\Output\Online Plotter\Online Plotter Without File\Type65d.tmf
*$POSITION 558 616
*$LAYER Outputs # 
PARAMETERS 12
3		! 1 Nb. of left-axis variables
0		! 2 Nb. of right-axis variables
0.0		! 3 Left axis minimum
10		! 4 Left axis maximum
0.0		! 5 Right axis minimum
100		! 6 Right axis maximum
1		! 7 Number of plots per simulation
12		! 8 X-axis gridpoints
0		! 9 Shut off Online w/o removing
-1		! 10 Logical unit for output file
0		! 11 Output file units
0		! 12 Output file delimiter
INPUTS 3
PL1		! Cond. and ORC:PL1 ->Left axis variable-1
PL2		! Cond. and ORC:PL2 ->Left axis variable-2
PL3		! Cond. and ORC:PL3 ->Left axis variable-3
*** INITIAL INPUT VALUES
PL1 PL2 PL3 
LABELS  3
"Temperatures"
"Heat transfer rates"
"ORC"
*------------------------------------------------------------------------------
*
* Model "Div-A" (Type 11)
* 
*
UNIT 83 TYPE 11	 Div-A
*$UNIT_NAME Div-A
*$MODEL .\Hydronics\Flow Diverter\Other Fluids\Type11f.tmf
*$POSITION 746 512
*$LAYER Main # 
PARAMETERS 1
2		! 1 Controlled flow diverter mode
INPUTS 3
63,1 		! Tee-2:Outlet temperature ->Inlet temperature
63,2 		! Tee-2:Outlet flow rate ->Inlet flow rate
0,0		! [unconnected] Control signal
*** INITIAL INPUT VALUES
20.0 100.0 0 
*------------------------------------------------------------------------------
*
* Model "T-high" (Type 649)
* 
*
UNIT 86 TYPE 649	 T-high
*$UNIT_NAME T-high
*$MODEL .\Hydronics Library (TESS)\Valves\Mixing Valve (100 Ports)\Other Fluids\Type649.tmf
*$POSITION 499 121
*$LAYER Water Loop # 
PARAMETERS 1
3		! 1 Number of inlets
INPUTS 6
87,1 		! Div-C:Temperature at outlet 1 ->Temperature at inlet-1
87,2 		! Div-C:Flow rate at outlet 1 ->Flow rate at inlet-1
70,1 		! Div-D:Temperature at outlet 1 ->Temperature at inlet-2
70,2 		! Div-D:Flow rate at outlet 1 ->Flow rate at inlet-2
76,1 		! Div-G:Temperature at outlet 1 ->Temperature at inlet-3
76,2 		! Div-G:Flow rate at outlet 1 ->Flow rate at inlet-3
*** INITIAL INPUT VALUES
20 200.0 20 200.0 20 200.0 
*------------------------------------------------------------------------------
*
* Model "T-mid-1" (Type 11)
* 
*
UNIT 100 TYPE 11	 T-mid-1
*$UNIT_NAME T-mid-1
*$MODEL .\Hydronics\Tee-Piece\Other Fluids\Type11h.tmf
*$POSITION 494 222
*$LAYER Water Loop # 
PARAMETERS 1
1		! 1 Tee piece mode
INPUTS 4
87,3 		! Div-C:Temperature at outlet 2 ->Temperature at inlet 1
87,4 		! Div-C:Flow rate at outlet 2 ->Flow rate at inlet 1
70,3 		! Div-D:Temperature at outlet 2 ->Temperature at inlet 2
70,4 		! Div-D:Flow rate at outlet 2 ->Flow rate at inlet 2
*** INITIAL INPUT VALUES
20.0 100.0 20.0 100.0 
*------------------------------------------------------------------------------
*
* Model "T-mid-2" (Type 11)
* 
*
UNIT 89 TYPE 11	 T-mid-2
*$UNIT_NAME T-mid-2
*$MODEL .\Hydronics\Tee-Piece\Other Fluids\Type11h.tmf
*$POSITION 494 302
*$LAYER Water Loop # 
PARAMETERS 1
1		! 1 Tee piece mode
INPUTS 4
0,0		! [unconnected] Temperature at inlet 1
0,0		! [unconnected] Flow rate at inlet 1
76,3 		! Div-G:Temperature at outlet 2 ->Temperature at inlet 2
76,4 		! Div-G:Flow rate at outlet 2 ->Flow rate at inlet 2
*** INITIAL INPUT VALUES
20.0 100.0 20.0 100.0 
*------------------------------------------------------------------------------
*
* EQUATIONS "Positive"
* 
EQUATIONS 2
Positive_1 = max( 0 , [97,2] )
Positive_2 = max( 0 , [97,4] )
*$UNIT_NAME Positive
*$LAYER Water Loop
*$POSITION 688 354
*
*------------------------------------------------------------------------------
*
*
* Model "T-mid-3" (Type 11)
* 
*
UNIT 101 TYPE 11	 T-mid-3
*$UNIT_NAME T-mid-3
*$MODEL .\Hydronics\Tee-Piece\Other Fluids\Type11h.tmf
*$POSITION 583 264
*$LAYER Water Loop # 
PARAMETERS 1
1		! 1 Tee piece mode
INPUTS 4
100,1 		! T-mid-1:Outlet temperature ->Temperature at inlet 1
100,2 		! T-mid-1:Outlet flow rate ->Flow rate at inlet 1
89,1 		! T-mid-2:Outlet temperature ->Temperature at inlet 2
89,2 		! T-mid-2:Outlet flow rate ->Flow rate at inlet 2
*** INITIAL INPUT VALUES
20.0 100.0 20.0 100.0 
*------------------------------------------------------------------------------
*
* Model "PTES" (Type 65)
* 
*
UNIT 62 TYPE 65	 PTES
*$UNIT_NAME PTES
*$MODEL .\Output\Online Plotter\Online Plotter Without File\Type65d.tmf
*$POSITION 180 629
*$LAYER Main # 
PARAMETERS 12
7		! 1 Nb. of left-axis variables
4		! 2 Nb. of right-axis variables
0.0		! 3 Left axis minimum
100		! 4 Left axis maximum
0.0		! 5 Right axis minimum
50000000		! 6 Right axis maximum
1		! 7 Number of plots per simulation
12		! 8 X-axis gridpoints
0		! 9 Shut off Online w/o removing
-1		! 10 Logical unit for output file
0		! 11 Output file units
0		! 12 Output file delimiter
INPUTS 11
52,1 		! 75.000 m3:Fluid Temp 1-1 ->Left axis variable-1
52,6 		! 75.000 m3:Fluid Temp 1-2 ->Left axis variable-2
52,11 		! 75.000 m3:Fluid Temp 1-3 ->Left axis variable-3
52,16 		! 75.000 m3:Fluid Temp 1-4 ->Left axis variable-4
52,21 		! 75.000 m3:Max Storage Temp ->Left axis variable-5
52,22 		! 75.000 m3:Ave Storage Temp ->Left axis variable-6
52,23 		! 75.000 m3:Min Storage Temp ->Left axis variable-7
52,3 		! 75.000 m3:Thermal Power 1-1 ->Right axis variable-1
52,8 		! 75.000 m3:Thermal Power 1-2 ->Right axis variable-2
52,13 		! 75.000 m3:Thermal Power 1-3 ->Right axis variable-3
52,18 		! 75.000 m3:Thermal Power 1-4 ->Right axis variable-4
*** INITIAL INPUT VALUES
Flow_T_1_1 Flow_T_1_2 Flow_T_1_3 Flow_T_1_4 Max_T Average_T Min_T Power_1
Power_2 Power_3 Power_4 
LABELS  3
"Temperatures"
"Heat transfer rates"
"Water pit heat storage"
*------------------------------------------------------------------------------
*
* Model "Tank-hourly" (Type 25)
* 
*
UNIT 65 TYPE 25	 Tank-hourly
*$UNIT_NAME Tank-hourly
*$MODEL .\Output\Printer\User-Supplied Units\Type25b.tmf
*$POSITION 640 163
*$LAYER Main # 
PARAMETERS 10
1		! 1 Printing interval
8760		! 2 Start time
STOP		! 3 Stop time
39		! 4 Logical unit
1		! 5 Units printing mode
0		! 6 Relative or absolute start time
-1		! 7 Overwrite or Append
1		! 8 Print header
0		! 9 Delimiter
1		! 10 Print labels
INPUTS 16
72,24 		! 2.100 m3:power through doubleport-1 ->Input to be printed-1
72,25 		! 2.100 m3:power through doubleport-2 ->Input to be printed-2
72,26 		! 2.100 m3:power through doubleport-3 ->Input to be printed-3
72,27 		! 2.100 m3:power through doubleport-4 ->Input to be printed-4
72,28 		! 2.100 m3:power through doubleport-5 ->Input to be printed-5
72,36 		! 2.100 m3:power through heat exchanger-1 ->Input to be printed-6
72,41 		! 2.100 m3:power through heat exchanger-2 ->Input to be printed-7
72,46 		! 2.100 m3:power through heat exchanger-3 ->Input to be printed-8
72,17 		! 2.100 m3:heat loss rate of the whole storage to ambient ->Input to be printed-9
72,18 		! 2.100 m3:heat loss rate of the storage-bottom to ambeint ->Input to be printed-10
72,19 		! 2.100 m3:heat loss rate of the storage-top to ambient ->Input to be printed-11
72,51 		! 2.100 m3:internal energy change of the storage ->Input to be printed-12
72,52 		! 2.100 m3:mean temperature of the storage ->Input to be printed-13
72,33 		! 2.100 m3:temperature at sensor-5 ->Input to be printed-14
72,29 		! 2.100 m3:temperature at sensor-1 ->Input to be printed-15
31,1 		! Type109-TMY2:Ambient temperature ->Input to be printed-16
*** INITIAL INPUT VALUES
Power_port_1 Power_port_2 Power_port_3 Power_port_4 Power_port_5
Power_hx_1 Power_hx_2 Power_hx_3 Heatloss_whole Heatloss_bot Heatloss_top
Energy_change Mean_temperature Max_T Min_T Tambient 
kJ/hr kJ/hr kJ/hr kJ/hr kJ/hr kJ/hr kJ/hr kJ/hr kJ/hr kJ/hr kJ/hr kJ C C C C
*** External files
ASSIGN "tank.txt" 39
*|? Output file for printed results |1000
*------------------------------------------------------------------------------
*
* Model "Tank" (Type 65)
* 
*
UNIT 92 TYPE 65	 Tank
*$UNIT_NAME Tank
*$MODEL .\Output\Online Plotter\Online Plotter Without File\Type65d.tmf
*$POSITION 681 275
*$LAYER Main # 
PARAMETERS 12
3		! 1 Nb. of left-axis variables
10		! 2 Nb. of right-axis variables
0.0		! 3 Left axis minimum
100		! 4 Left axis maximum
-10000000		! 5 Right axis minimum
50000000		! 6 Right axis maximum
1		! 7 Number of plots per simulation
12		! 8 X-axis gridpoints
0		! 9 Shut off Online w/o removing
-1		! 10 Logical unit for output file
0		! 11 Output file units
0		! 12 Output file delimiter
INPUTS 13
72,33 		! 2.100 m3:temperature at sensor-5 ->Left axis variable-1
72,52 		! 2.100 m3:mean temperature of the storage ->Left axis variable-2
72,29 		! 2.100 m3:temperature at sensor-1 ->Left axis variable-3
72,24 		! 2.100 m3:power through doubleport-1 ->Right axis variable-1
72,25 		! 2.100 m3:power through doubleport-2 ->Right axis variable-2
72,26 		! 2.100 m3:power through doubleport-3 ->Right axis variable-3
72,27 		! 2.100 m3:power through doubleport-4 ->Right axis variable-4
72,28 		! 2.100 m3:power through doubleport-5 ->Right axis variable-5
72,36 		! 2.100 m3:power through heat exchanger-1 ->Right axis variable-6
72,41 		! 2.100 m3:power through heat exchanger-2 ->Right axis variable-7
72,17 		! 2.100 m3:heat loss rate of the whole storage to ambient ->Right axis variable-8
72,18 		! 2.100 m3:heat loss rate of the storage-bottom to ambeint ->Right axis variable-9
72,19 		! 2.100 m3:heat loss rate of the storage-top to ambient ->Right axis variable-10
*** INITIAL INPUT VALUES
Max_T Mean_T Min_T Power_Port_1 Power_Port_2 Power_Port_3 Power_Port_4
Power_Port_5 Power_hx_1 Power_hx_2 Heatloss_whole Heatloss_bot Heatloss_top
*
LABELS  3
"Temperatures C"
"Heat transfer rates kJ/hr"
"Tank heat storage"
*------------------------------------------------------------------------------
*
END
